<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>混凝土澆置回報 App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
        }
        /* 自定義樣式，用於防止數字輸入框出現上下箭頭 */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-md bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 space-y-6">
        <!-- 標題 -->
        <div class="text-center">
            <h1 class="text-2xl md:text-3xl font-bold text-cyan-400">混凝土澆置回報</h1>
            <p class="text-gray-400 mt-1">114年7月14日</p>
        </div>

        <!-- 資訊卡片 -->
        <div class="bg-gray-700/50 p-6 rounded-lg space-y-4">
            <div class="flex justify-between items-center">
                <span class="text-gray-400 text-sm">澆置位置</span>
                <span class="font-semibold text-right">8F柱牆 / 9F樑板區</span>
            </div>
            <hr class="border-gray-600">
            <div class="flex justify-between items-center">
                <span class="text-gray-400 text-sm">灌漿回報</span>
                <span class="font-semibold">09:50 開始澆置</span>
            </div>
            <hr class="border-gray-600">
            <div class="flex justify-between items-center">
                <span class="text-gray-400 text-sm">平均每小時</span>
                <span class="font-semibold">100 M³ (2台壓送)</span>
            </div>
            <hr class="border-gray-600">
            <div class="flex justify-between items-center">
                <span class="text-gray-400 text-sm">本日預計總數</span>
                <span class="font-semibold">625 M³</span>
            </div>
        </div>

        <!-- 動態更新區域 -->
        <div class="space-y-4">
            <div class="bg-gray-700/50 p-4 rounded-lg">
                <label for="m3-per-truck" class="block text-sm font-medium text-gray-400 mb-2">設定每車平均方數 (M³)</label>
                <input type="number" id="m3-per-truck" value="5.5" class="w-full bg-gray-800 border border-gray-600 rounded-md p-2 text-center text-white font-bold text-lg focus:ring-2 focus:ring-cyan-500 focus:outline-none">
            </div>

            <div class="grid grid-cols-2 gap-4 text-center">
                <div class="bg-gray-900 p-4 rounded-lg flex flex-col items-center justify-center">
                    <p class="text-sm text-gray-400">累積出車 (可點擊修改)</p>
                    <input type="number" id="truck-count-input" value="0" class="w-full bg-transparent text-4xl font-bold text-amber-400 text-center focus:outline-none p-0 m-0 border-0">
                    <p class="text-sm text-gray-400">車</p>
                </div>
                <div class="bg-gray-900 p-4 rounded-lg">
                    <p class="text-sm text-gray-400">累積澆置數量</p>
                    <p id="volume-count" class="text-4xl font-bold text-green-400">0.0</p>
                    <p class="text-sm text-gray-400">M³</p>
                </div>
            </div>

            <!-- 控制按鈕 -->
            <div class="grid grid-cols-2 gap-4">
                <button id="add-truck" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform active:scale-95">
                    增加一車
                </button>
                <button id="subtract-truck" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform active:scale-95">
                    減少一車
                </button>
            </div>
             <button id="reset-counts" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform active:scale-95">
                重設數據
            </button>
        </div>

        <!-- 操作按鈕 -->
        <div>
            <button id="copy-report" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center gap-2 transition-transform transform active:scale-95">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                    <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2H6zM8 7a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1zm-1 4a1 1 0 100 2h4a1 1 0 100-2H7z" />
                </svg>
                <span id="copy-text">一鍵複製回報內容</span>
            </button>
        </div>
    </div>

    <script>
        // DOM 元素
        const truckCountInput = document.getElementById('truck-count-input');
        const volumeCountEl = document.getElementById('volume-count');
        const m3PerTruckInput = document.getElementById('m3-per-truck');
        const addTruckBtn = document.getElementById('add-truck');
        const subtractTruckBtn = document.getElementById('subtract-truck');
        const resetBtn = document.getElementById('reset-counts');
        const copyBtn = document.getElementById('copy-report');
        const copyTextEl = document.getElementById('copy-text');

        // 更新顯示的函數
        function updateDisplay() {
            let truckCount = parseInt(truckCountInput.value, 10) || 0;
            if (truckCount < 0) { // 防止負數
                truckCount = 0;
                truckCountInput.value = 0;
            }
            const m3PerTruck = parseFloat(m3PerTruckInput.value) || 0;
            const volumeCount = truckCount * m3PerTruck;

            volumeCountEl.textContent = volumeCount.toFixed(1); // 顯示到小數點後一位
        }

        // 事件監聽器
        addTruckBtn.addEventListener('click', () => {
            truckCountInput.value = (parseInt(truckCountInput.value, 10) || 0) + 1;
            updateDisplay();
        });

        subtractTruckBtn.addEventListener('click', () => {
            let currentCount = parseInt(truckCountInput.value, 10) || 0;
            if (currentCount > 0) {
                truckCountInput.value = currentCount - 1;
                updateDisplay();
            }
        });
        
        resetBtn.addEventListener('click', () => {
            // 使用自定義的提示框代替 confirm
            if (window.confirm('您確定要重設所有累積數據嗎？')) {
                 truckCountInput.value = 0;
                 updateDisplay();
            }
        });

        // 當手動輸入車輛或每車方數時，自動更新總量
        truckCountInput.addEventListener('input', updateDisplay);
        m3PerTruckInput.addEventListener('input', updateDisplay);

        copyBtn.addEventListener('click', () => {
            const date = "114/7/14";
            const location = "8F柱牆9FL樑板區";
            const startTime = "09:50";
            const rate = "100M3/小時 (2台壓送)";
            const totalEstimate = "625M3";
            const currentTrucks = truckCountInput.value;
            const currentVolume = volumeCountEl.textContent;

            const reportText = `
--- 混凝土澆置回報 ---
日期: ${date}
澆置位置: ${location}
灌漿回報: ${startTime} 開始澆置
平均每小時: ${rate}
本日預計: ${totalEstimate}
--------------------
目前進度:
➡️ 累積出車: ${currentTrucks} 車
➡️ 累積澆置: ${currentVolume} M³
            `.trim();

            // 創建一個臨時的 textarea 來複製文本
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = reportText;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            try {
                document.execCommand('copy');
                // 顯示成功訊息
                const originalText = copyTextEl.textContent;
                copyTextEl.textContent = '已複製！';
                copyBtn.classList.remove('bg-cyan-600', 'hover:bg-cyan-700');
                copyBtn.classList.add('bg-green-500');

                setTimeout(() => {
                    copyTextEl.textContent = originalText;
                    copyBtn.classList.remove('bg-green-500');
                    copyBtn.classList.add('bg-cyan-600', 'hover:bg-cyan-700');
                }, 2000);

            } catch (err) {
                console.error('無法複製文字: ', err);
                // 使用自定義的提示框代替 alert
                alert('複製失敗，您的瀏覽器可能不支援此功能。');
            }
            document.body.removeChild(tempTextArea);
        });

        // 頁面載入時初始化顯示
        updateDisplay();
    </script>

</body>
</html>
